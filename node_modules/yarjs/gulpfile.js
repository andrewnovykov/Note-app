'use strict';

var gulp	= require('gulp'),
	jshint	= require('gulp-jshint'),
	beep	= require('beepbeep'),
	rename	= require('gulp-rename'),
	concat	= require('gulp-concat'),
	stylish	= require('jshint-stylish'),
	watch	= require('gulp-watch'),
	uglify	= require('gulp-uglify')
	;

var FN_BASE = 'yar';

var PATHS = {
	SRC: ['./src/head.js','./src/lib/**/*'],
	DIST: './dist'
};

function errorbeep(){ beep([200,200,200,200,200]); }

gulp.task('build', function() {

	beep([0]);

	gulp.src(PATHS.SRC)
		.pipe(jshint())
		.pipe(jshint.reporter(stylish))
		.pipe(jshint.reporter(errorbeep))
		.pipe(concat(FN_BASE+'.js'))
		.pipe(gulp.dest(PATHS.DIST))
		.pipe(rename(FN_BASE+'.min.js'))
		.pipe(uglify())		
		.pipe(gulp.dest(PATHS.DIST));

});

gulp.task('watch', ['build'], function() {

	watch(PATHS.SRC, function() {
		gulp.start('build');
	});

});

gulp.task('default', ['watch']);