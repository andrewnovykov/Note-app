(function() {

	'use strict';

	function $Yar(imp_func_name, exp_func_name) {

		var exps = {};
		var deps = {};

		imp_func_name = imp_func_name || '__import';
		exp_func_name = exp_func_name || '__export';
		
		this[imp_func_name] = function() {

			var e, r = 0, original, num_args = arguments.length, depfunc, exports;
			
			if(num_args === 0) return;
			if(num_args === 1) return arguments[0]();

			depfunc = arguments[num_args-1];

			exports  = num_args > 2 ? Array.prototype.slice.call(arguments,0,num_args-1) : arguments[0].split(/[\s,]+/);

			original = exports.slice(0);	

			r = 0;
			
			while( (e = exports.pop()) && (exps[e] || ++r) ) {

				( deps[e] || (deps[e]=[]) )
					.push(execIfNoDeps);

			}

			execIfNoDeps(++r);

			exports = [];
			
			function execIfNoDeps() {
			
				if(--r) return;
				
				while( (r = original.shift()) ) {
					exports.push(exps[r]);
				}

				depfunc.apply(null, exports);
				
			}

		};

		this[exp_func_name] = function(exp, object) {
			
			var d;

			exps[exp] = object;

			if(deps[exp]) for(d in deps[exp]) deps[exp][d]();		

		};

	}

	window.$Yar = $Yar;
	$Yar.call(window);

})();